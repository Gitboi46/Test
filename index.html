<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>AR Shopping Experience</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #001a1a;
      color: #f2f2f2;
      width: 100%;
      height: 100%;   
      overflow: hidden;
    }
    #cameraBackground {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      object-fit: cover;
      z-index: 1;
    }
    #introScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
    }
    .intro-ripple {
      position: absolute;
      width: 300px; height: 300px;
      border-radius: 50%;
      border: 1px solid rgba(0, 255, 204, 0.2);
      animation: rippleExpand 3s ease-out infinite;
    }
    .intro-ripple:nth-child(2) { animation-delay: 1s; }
    .intro-ripple:nth-child(3) { animation-delay: 2s; }
    @keyframes rippleExpand {
      0% { transform: scale(0.5); opacity: 1; }
      100% { transform: scale(2); opacity: 0; }
    }
    .press-button {
      position: relative;
      width: 180px; height: 180px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(0, 255, 204, 0.2), rgba(0, 220, 180, 0.1), rgba(0, 180, 140, 0.15));
      border: 2px solid rgba(0, 255, 204, 0.3);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: bold;
      color: #00ffcc;
      text-align: center;
      animation: pulseButton 2.5s infinite;
      backdrop-filter: blur(10px);
      z-index: 10;
    }
    @keyframes pulseButton {
      0%, 100% { transform: scale(1); box-shadow: 0 0 40px rgba(0, 255, 204, 0.3); }
      50% { transform: scale(1.02); box-shadow: 0 0 60px rgba(0, 255, 204, 0.4); }
    }
    .press-button:active { transform: scale(0.95); }

    #videoScreen, #modelsScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 90;
      overflow: hidden;
      background: transparent;
    }
    #videoScreen { display: none; align-items: center; justify-content: center; perspective: 1200px; }
    #modelsScreen { display: none; flex-direction: column; }

    .particles-container {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      overflow: hidden;
      z-index: 2;
    }

    .particle {
      position: absolute;
      border-radius: 50%;
      animation: floatParticle linear infinite;
    }
    .particle.glow { background: radial-gradient(circle, rgba(0,255,204,0.7) 0%, transparent 70%); box-shadow: 0 0 6px rgba(0,255,204,0.5); }
    .particle.spark { background: radial-gradient(circle, rgba(0,255,230,0.8) 0%, transparent 70%); box-shadow: 0 0 5px rgba(0,255,230,0.4); }
    .particle.orb { background: radial-gradient(circle, rgba(0,220,180,0.8) 0%, transparent 70%); box-shadow: 0 0 6px rgba(0,220,180,0.4); }

    @keyframes floatParticle {
      0% { transform: translateY(100vh) rotate(0deg) scale(0.5); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 0.8; }
      100% { transform: translateY(-50px) rotate(720deg) scale(0.5); opacity: 0; }
    }
    .particle.sway { animation: floatParticleSway linear infinite; }
    @keyframes floatParticleSway {
      0% { transform: translateY(100vh) translateX(0) scale(0.5); opacity: 0; }
      10% { opacity: 1; }
      50% { transform: translateY(50vh) translateX(-15px) scale(1); }
      100% { transform: translateY(-50px) translateX(0) scale(0.5); opacity: 0; }
    }

    .sound-waves {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      align-items: flex-end;
      gap: 4px;
      height: 35px;
      z-index: 96;
    }
    .wave-bar {
      width: 3px;
      background: linear-gradient(to top, #00ffcc, #00ffc4, #00ff99);
      border-radius: 3px;
      animation: waveAnimation 0.5s ease-in-out infinite alternate;
      box-shadow: 0 0 8px rgba(0, 255, 204, 0.4);
    }
    @keyframes waveAnimation {
      0% { height: 5px; }
      100% { height: 28px; }
    }

    .spatial-container { position: relative; transform-style: preserve-3d; transition: transform 0.1s ease-out; z-index: 10; }
    .spatial-frame { position: relative; width: 220px; height: 390px; transform-style: preserve-3d; }
    .video-glow { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 250px; height: 420px; border-radius: 20px; background: radial-gradient(ellipse at center, rgba(0, 255, 204, 0.25) 0%, transparent 70%); filter: blur(30px); animation: bgGlowPulse 3s ease-in-out infinite; pointer-events: none; z-index: -1; }
    .video-glow-secondary { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 280px; height: 450px; border-radius: 25px; background: radial-gradient(ellipse at center, rgba(0, 220, 180, 0.2) 0%, transparent 65%); filter: blur(40px); animation: bgGlowPulse2 4s ease-in-out infinite; pointer-events: none; z-index: -1; }
    @keyframes bgGlowPulse { 0%,100% { opacity:0.5; transform:translate(-50%,-50%) scale(1); } 50% { opacity:0.7; transform:translate(-50%,-50%) scale(1.05); } }
    @keyframes bgGlowPulse2 { 0%,100% { opacity:0.4; } 50% { opacity:0.6; transform:scale(1.05); } }

    .depth-layer-back { position: absolute; top: 8px; left: 8px; width: 204px; height: 374px; background: rgba(0,0,0,0.2); border-radius: 12px; transform: translateZ(-60px); }
    .depth-layer-mid { position: absolute; top: 4px; left: 4px; width: 212px; height: 382px; background: rgba(0,0,0,0.15); border-radius: 14px; transform: translateZ(-30px); }
    .video-spatial-container { position: relative; width: 220px; height: 390px; transform-style: preserve-3d; border-radius: 15px; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.5), 0 0 40px rgba(0, 255, 204, 0.15); }
    #videoPlayer { width: 100%; height: 100%; object-fit: cover; border-radius: 15px; }
    .visualize-button { position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%); padding: 8px 18px; font-size: 10px; font-weight: 500; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); backdrop-filter: blur(10px); color: #f7faf9; cursor: pointer; text-transform: uppercase; letter-spacing: 0.5px; z-index: 10; opacity: 0; visibility: hidden; transition: all 0.5s ease; }
    .visualize-button.visible { opacity: 1; visibility: visible; }
    .visualize-button:active { transform: translateX(-50%) scale(0.95); }
    .floor-shadow { position: absolute; bottom: -60px; left: 50%; transform: translateX(-50%); width: 180px; height: 80px; background: radial-gradient(ellipse at center, rgba(0,0,0,0.4) 0%, transparent 70%); filter: blur(15px); }

    .models-scroll-container { flex: 1; overflow-y: auto; padding: 20px 12px; padding-bottom: 100px; }
    .models-header { text-align: center; margin-bottom: 20px; padding: 20px 15px; background: rgba(0,0,0,0.3); backdrop-filter: blur(10px); border-radius: 15px; }
    .models-header h2 { font-size: 22px; font-weight: 700; margin-bottom: 5px; color: #fdaa10; }
    .models-header p { font-size: 12px; opacity: 0.7; }

    .shoes-grid { display: grid; grid-template-columns: 1fr; gap: 15px; max-width: 400px; margin: 0 auto; padding-bottom: 20px; }
    .shoe-card { background: transparent; border-radius: 20px; overflow: visible; opacity: 0; animation: cardFadeIn 0.6s ease-out forwards; position: relative; transition: transform 0.3s ease; }
    .shoe-card:nth-child(n) { animation-delay: calc(0.1s * var(--i)); }

    @keyframes cardFadeIn {
      0% { opacity: 0; transform: translateY(20px) scale(0.95); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }

    .model-wrap {
      height: 190px;
      width: 280px;
      margin: 0 auto;
      background: rgba(40, 40, 50, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 18px;
      overflow: hidden;
      position: relative;
      backdrop-filter: blur(12px);
      box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.05), 0 8px 25px rgba(0, 0, 0, 0.5);
    }

    .slider-container {
      width: 100%;
      height: 100%;
      position: relative;
      overflow: hidden;
    }

    .slide {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.4s ease, transform 0.4s ease;
    }

    .slide img, .slide video {
      max-width: 88%;
      max-height: 88%;
      object-fit: contain;
      border-radius: 12px;
    }

    .slide.video-slide video {
      position: absolute;
      width: 88%;
      height: 88%;
    }

    .slide.image-slide {
      z-index: 2;
      opacity: 1;
      transform: translateX(0);
    }

    .slide.video-slide {
      z-index: 1;
      opacity: 0;
      transform: translateX(100%);
    }

    .slider-container.video-active .image-slide {
      opacity: 0;
      transform: translateX(-100%);
    }

    .slider-container.video-active .video-slide {
      opacity: 1;
      transform: translateX(0);
      z-index: 3;
    }

    .nav-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 36px;
      height: 36px;
      background: rgba(0,0,0,0.5);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: white;
      cursor: pointer;
      z-index: 10;
      user-select: none;
      opacity: 0.7;
    }
    .nav-arrow.left { left: 10px; }
    .nav-arrow.right { right: 10px; }
    .nav-arrow:active { opacity: 1; transform: translateY(-50%) scale(0.9); }

    .dots-indicator {
      position: absolute;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      z-index: 11;
    }
    .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255,255,255,0.4);
      transition: all 0.3s ease;
    }
    .dot.active {
      background: #00ffcc;
      box-shadow: 0 0 8px #00ffcc;
      transform: scale(1.3);
    }

    .info {
      padding: 18px 15px;
      text-align: center;
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      margin-top: 10px;
    }
    .info h3 { font-size: 18px; margin-bottom: 5px; font-weight: 600; color: #ffb10a; }
    .info .price { opacity: 0.7; font-size: 15px; margin-bottom: 15px; color: #ffffff; }
    .btn-order-now {
      background: linear-gradient(135deg, #e59c00, #ffb10a);
      color: #000;
      border: none;
      padding: 14px 20px;
      border-radius: 30px;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      width: 100%;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .btn-order-now:active {
      transform: scale(0.97);
      box-shadow: 0 0 20px rgba(0, 255,204,0.6);
    }
    .btn-order-now::after {
      content: '';
      position: absolute;
      top: 50%; left: 50%;
      width: 0; height: 0;
      background: rgba(255,255,255,0.3);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.4s, height 0.4s;
    }
    .btn-order-now:active::after {
      width: 300px;
      height: 300px;
    }

    .ad-banner {
      margin: 20px auto;
      max-width: 360px;
      background: linear-gradient(135deg, rgba(255, 145, 11, 0.15), rgba(0, 255, 204, 0.1));
      border: 1px solid rgba(255, 145, 11, 0.4);
      border-radius: 20px;
      padding: 18px 15px;
      text-align: center;
      backdrop-filter: blur(12px);
      box-shadow: 0 8px 32px rgba(255, 145, 11, 0.2);
    }
    .ad-banner h3 { font-size: 20px; color: #ffb10a; margin-bottom: 6px; font-weight: 700; }
    .ad-banner p { font-size: 14px; color: #ffffff; margin-bottom: 10px; }
    .ad-banner .highlight { font-size: 24px; font-weight: 900; background: linear-gradient(90deg, #ffb10a, #ff6b00); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .ad-banner .cta { margin-top: 12px; padding: 10px 24px; background: #ffb10a; color: #000; border: none; border-radius: 30px; font-weight: 700; font-size: 13px; cursor: pointer; }

    .back-to-video-btn {
      position: fixed;
      bottom: 25px; left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.4);
      border: 1px solid rgba(255,255,255,0.2);
      color: #e6e6e6;
      padding: 12px 30px;
      border-radius: 25px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      z-index: 86;
      backdrop-filter: blur(10px);
    }
    .back-to-video-btn:active { transform: translateX(-50%) scale(0.95); }
  </style>
</head>
<body>
  <video id="cameraBackground" autoplay playsinline muted></video>

  <div id="introScreen">
    <div class="intro-ripple"></div>
    <div class="intro-ripple"></div>
    <div class="intro-ripple"></div>
    <button class="press-button" id="startBtn">TAP TO<br>START</button>
  </div>

  <div id="videoScreen">
    <div class="particles-container" id="particlesContainer"></div>
    <div class="sound-waves" id="soundWaves">
      <div class="wave-bar" style="animation-delay: 0s;"></div>
      <div class="wave-bar" style="animation-delay: 0.1s;"></div>
      <div class="wave-bar" style="animation-delay: 0.2s;"></div>
      <div class="wave-bar" style="animation-delay: 0.3s;"></div>
      <div class="wave-bar" style="animation-delay: 0.4s;"></div>
      <div class="wave-bar" style="animation-delay: 0.35s;"></div>
      <div class="wave-bar" style="animation-delay: 0.25s;"></div>
      <div class="wave-bar" style="animation-delay: 0.15s;"></div>
      <div class="wave-bar" style="animation-delay: 0.05s;"></div>
    </div>

    <div class="spatial-container" id="spatialContainer">
      <div class="spatial-frame">
        <div class="video-glow"></div>
        <div class="video-glow-secondary"></div>
        <div class="depth-layer-back"></div>
        <div class="depth-layer-mid"></div>
        <div class="video-spatial-container">
          <!-- Removed muted so audio plays after user gesture -->
          <video id="videoPlayer" playsinline loop preload="metadata">
            <source src="https://raw.githubusercontent.com/ElwinRoy/ModelViewer/main/Avatar%20IV%20Standing.mp4" type="video/mp4">
          </video>
          <button class="visualize-button" id="visualizeBtn">View Products</button>
        </div>
        <div class="floor-shadow"></div>
      </div>
    </div>
  </div>

  <div id="modelsScreen">
    <div class="models-scroll-container" id="scrollContainer">
      <div class="models-header">
        <h2>Choose Your Product</h2>
        <p>Select a Product to Order</p>
      </div>
      <div class="shoes-grid" id="shoesGrid"></div>
    </div>
    <button class="back-to-video-btn" id="backToVideoBtn">Back to Video</button>
  </div>

  <script>
    const shoes = [
      { name: "Book Marker",   price: "₹550.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Book%20Marker.png", video: "https://raw.githubusercontent.com/Gitboi46/Test/main/Book-Mark.mp4", link: "https://test.4point2tech.com/product/bookmarks/" },
      { name: "Calendar",      price: "₹199.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Calander.png", video: "https://raw.githubusercontent.com/Gitboi46/Test/main/Calender.mp4", link: "https://test.4point2tech.com/product/calendar/" },
      { name: "Story Book",    price: "₹499.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Story%20Book.png", video: "https://assets.mixkit.co/videos/preview/mixkit-stars-in-space-1610-large.mp4", link: "https://test.4point2tech.com/product/story-book/" },
      { name: "Diary",         price: "₹599.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Dairy.png", video: "https://raw.githubusercontent.com/Gitboi46/Test/main/Diary-Book.mp4", link: "https://test.4point2tech.com/product/dairy/" },
      { name: "Bottle",        price: "₹449.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Bottle.png", video: "https://raw.githubusercontent.com/Gitboi46/Test/main/Water-Bottle.mp4", link: "https://test.4point2tech.com/product/water-bottle/" },
      { name: "Drawing Book",  price: "₹199.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Drawing%20book.png", video: "https://assets.mixkit.co/videos/preview/mixkit-young-woman-modeling-in-a-studio-1256-large.mp4", link: "https://test.4point2tech.com/product/drawing-book/" },
      { name: "Fridge Magnet", price: "₹499.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Fridge%20Magnet.png", video: "https://raw.githubusercontent.com/Gitboi46/Test/main/Fridge-Magnet.mp4", link: "https://test.4point2tech.com/product/fridge-magnet/" },
      { name: "Key Chain",     price: "₹149.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Key%20Chain.png", video: "https://raw.githubusercontent.com/Gitboi46/Test/main/Key-Chain.mp4", link: "https://test.4point2tech.com/product/key-chain/" },
      { name: "Photo Frame",   price: "₹399.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Photo%20Frame.png", video: "https://raw.githubusercontent.com/Gitboi46/Test/main/Photo-Frame.mp4", link: "https://test.4point2tech.com/product/photo-frame/" },
      { name: "Sticker",       price: "₹199.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Sticker.png", video: "https://assets.mixkit.co/videos/preview/mixkit-woman-walking-in-a-field-with-dry-grass-1253-large.mp4", link: "https://test.4point2tech.com/product/testing-11/" },
      { name: "Tote Bag",      price: "₹599.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/Tota%20bag.png", video: "https://raw.githubusercontent.com/Gitboi46/Test/main/Totle-Bag.mp4", link: "https://test.4point2tech.com/product/tote-bag/" },
      { name: "Pocket Card",   price: "₹199.00", img: "https://raw.githubusercontent.com/Gitboi46/Productapp/main/pocket%20card.png", video: "https://raw.githubusercontent.com/Gitboi46/Test/main/Pocket-Cards.mp4", link: "https://test.4point2tech.com/product/pocket-card/" }
    ];

    const $ = id => document.getElementById(id);
    const el = {
      camera: $("cameraBackground"),
      intro: $("introScreen"),
      video: $("videoScreen"),
      models: $("modelsScreen"),
      startBtn: $("startBtn"),
      visualizeBtn: $("visualizeBtn"),
      videoPlayer: $("videoPlayer"),
      shoesGrid: $("shoesGrid"),
      backToVideoBtn: $("backToVideoBtn"),
      particlesContainer: $("particlesContainer")
    };

    const Haptic = {
      supported: 'vibrate' in navigator,
      excite() { if(this.supported) navigator.vibrate([60,60,60,60,120,80,200]); },
      startup() { if(this.supported) navigator.vibrate([100,80,100,80,200,100,300]); },
      videoPulse: null,
      videoStart() {
        if(!this.supported) return;
        const pattern = [40,80,40,80,40,120];
        const pulse = () => navigator.vibrate(pattern);
        pulse();
        this.videoPulse = setInterval(pulse, 1200);
      },
      videoStop() {
        if(this.videoPulse) clearInterval(this.videoPulse);
        if(this.supported) navigator.vibrate(0);
      }
    };

    async function initCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
        el.camera.srcObject = stream;
      } catch (e) {
        document.body.style.background = "#001a1a";
      }
    }
    initCamera();

    function createParticles() {
      const c = el.particlesContainer; c.innerHTML = '';
      for (let i = 0; i < 12; i++) {
        const p = document.createElement('div');
        p.className = `particle ${['glow','spark','orb'][i%3]} ${i%2 ? 'sway' : ''}`;
        const s = Math.random()*3 + 2;
        p.style.width = p.style.height = s + 'px';
        p.style.left = Math.random()*100 + '%';
        p.style.animationDuration = (Math.random()*5 + 6) + 's';
        p.style.animationDelay = Math.random()*6 + 's';
        c.appendChild(p);
      }
    }

    // Play main video with audio after user gesture
    async function playMainVideo() {
      try {
        await el.videoPlayer.play();
      } catch (err) {
        console.log("Play interrupted:", err);
      }
    }

    el.startBtn.onclick = () => {
      Haptic.startup();
      el.intro.style.display = "none";
      el.video.style.display = "flex";
      playMainVideo(); // now plays with sound
      Haptic.videoStart();
      createParticles();
      setTimeout(() => el.visualizeBtn.classList.add('visible'), 5000);
    };

    el.visualizeBtn.onclick = () => {
      Haptic.excite();
      Haptic.videoStop();
      el.videoPlayer.pause(); // Explicit pause
      el.video.style.display = "none";
      el.models.style.display = "flex";
    };

    el.backToVideoBtn.onclick = () => {
      el.models.style.display = "none";
      el.video.style.display = "flex";
      el.videoPlayer.currentTime = 0;
      playMainVideo(); // resume with audio
      Haptic.videoStart();
      createParticles();
    };

    shoes.forEach((shoe, i) => {
      const card = document.createElement("div");
      card.className = "shoe-card";
      card.style.setProperty('--i', i);

      card.innerHTML = `
        <div class="model-wrap">
          <div class="slider-container" id="slider-${i}">
            <div class="slide image-slide">
              <img src="${shoe.img}" alt="${shoe.name}">
            </div>
            <div class="slide video-slide">
              <video src="${shoe.video}" loop muted playsinline preload="none"></video>
            </div>
            <div class="nav-arrow left">←</div>
            <div class="nav-arrow right">→</div>
            <div class="dots-indicator">
              <div class="dot active"></div>
              <div class="dot"></div>
            </div>
          </div>
        </div>
        <div class="info">
          <h3>${shoe.name}</h3>
          <div class="price">${shoe.price}</div>
          <button class="btn-order-now">Order Now</button>
        </div>`;

      el.shoesGrid.appendChild(card);

      const container = card.querySelector('.slider-container');
      const video = card.querySelector('video');
      const dots = card.querySelectorAll('.dot');
      const leftArrow = card.querySelector('.nav-arrow.left');
      const rightArrow = card.querySelector('.nav-arrow.right');

      const showImage = () => {
        container.classList.remove('video-active');
        video.pause();
        video.currentTime = 0;
        dots[0].classList.add('active');
        dots[1].classList.remove('active');
      };

      const showVideo = () => {
        container.classList.add('video-active');
        video.play().catch(() => {});
        dots[0].classList.remove('active');
        dots[1].classList.add('active');
      };

      showImage(); // initial

      leftArrow.onclick = (e) => {
        e.stopPropagation();
        showImage();
      };

      rightArrow.onclick = (e) => {
        e.stopPropagation();
        showVideo();
      };

      // Touch swipe
      let touchStartX = 0;
      const wrap = card.querySelector('.model-wrap');
      wrap.addEventListener('touchstart', e => {
        touchStartX = e.touches[0].clientX;
      }, { passive: true });

      wrap.addEventListener('touchend', e => {
        if (!touchStartX) return;
        const diff = touchStartX - e.changedTouches[0].clientX;
        if (Math.abs(diff) > 50) {
          if (diff > 0) showVideo();
          else showImage();
        }
        touchStartX = 0;
      });

      card.querySelector('.btn-order-now').onclick = () => {
        Haptic.excite();
        window.open(shoe.link, '_blank');
      };

      if ((i + 1) % 2 === 0 && i !== shoes.length - 1) {
        const ad = document.createElement("div");
        ad.className = "ad-banner";
        ad.innerHTML = `<h3>FLASH SALE!</h3><p>Get <span class="highlight">UPTO 50% OFF</span></p><p>Limited Time Offer</p><button class="cta" onclick="window.open('https://test.4point2tech.com/', '_blank')">Shop Now</button>`;
        el.shoesGrid.appendChild(ad);
      }
    });
  </script>
</body>
</html>
